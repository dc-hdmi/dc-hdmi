<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>íŠ¸í¬ ë£°ë › ê²Œì„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      padding: 20px;
    }

    #inputArea {
      margin-bottom: 20px;
    }

    input {
      margin: 5px;
      padding: 5px;
      width: 120px;
    }

    select {
      margin-bottom: 10px;
      padding: 5px;
      font-size: 16px;
    }

    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      cursor: pointer;
    }

    canvas {
      border: 2px solid #888;
      margin-top: 20px;
      max-width: 90%;
    }
  </style>
</head>
<body>
  <h1>ğŸ¡ ë£°ë › ê²Œì„</h1>

  <div>
    ì°¸ê°€ì ìˆ˜:
    <select id="participantCount" onchange="updateInputFields()">
      <!-- 2~20ê¹Œì§€ ì„ íƒ ê°€ëŠ¥ -->
      <option value="2">2ëª…</option>
      <option value="3">3ëª…</option>
      <option value="4">4ëª…</option>
      <option value="5">5ëª…</option>
      <option value="6">6ëª…</option>
      <option value="7">7ëª…</option>
      <option value="8">8ëª…</option>
      <option value="9">9ëª…</option>
      <option value="10">10ëª…</option>
      <option value="11">11ëª…</option>
      <option value="12">12ëª…</option>
      <option value="13">13ëª…</option>
      <option value="14">14ëª…</option>
      <option value="15">15ëª…</option>
      <option value="16">16ëª…</option>
      <option value="17">17ëª…</option>
      <option value="18">18ëª…</option>
      <option value="19">19ëª…</option>
      <option value="20">20ëª…</option>
    </select>
  </div>

  <div id="inputArea">
    <!-- ì…ë ¥ì°½ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
    <button onclick="spin()">ëŒë¦¬ê¸°!</button>
  </div>

  <canvas id="wheelCanvas" width="400" height="400"></canvas>

  <script>
    const canvas = document.getElementById("wheelCanvas");
    const ctx = canvas.getContext("2d");
    const radius = canvas.width / 2;
    const center = { x: radius, y: radius };
    let items = [];
    let colors = [];
    let angleOffset = 0;
    let spinning = false;

    function updateInputFields() {
      const count = parseInt(document.getElementById("participantCount").value);
      const inputArea = document.getElementById("inputArea");

      // ê¸°ì¡´ ì…ë ¥ì°½ ì œê±° (ë²„íŠ¼ ì œì™¸)
      inputArea.innerHTML = '';
      
      for (let i = 0; i < count; i++) {
        const input = document.createElement("input");
        input.type = "text";
        input.placeholder = `í•­ëª© ${i + 1}`;
        input.id = `item${i}`;
        inputArea.appendChild(input);
      }

      // ëŒë¦¬ê¸° ë²„íŠ¼ ë‹¤ì‹œ ì¶”ê°€
      const button = document.createElement("button");
      button.textContent = "ëŒë¦¬ê¸°!";
      button.onclick = spin;
      inputArea.appendChild(document.createElement("br"));
      inputArea.appendChild(button);
      
      drawWheel();
    }

    function getItems() {
      items = [];
      const count = parseInt(document.getElementById("participantCount").value);
      for (let i = 0; i < count; i++) {
        const el = document.getElementById(`item${i}`);
        if (el && el.value.trim()) items.push(el.value.trim());
      }
      if (items.length < 2) {
        alert("ìµœì†Œ 2ê°œ ì´ìƒì˜ í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”.");
        return false;
      }
      generateColors();
      return true;
    }

    function generateColors() {
      colors = [];
      const usedHues = new Set();
      while (colors.length < items.length) {
        let hue;
        do {
          hue = Math.floor(Math.random() * 360);
        } while (usedHues.has(hue));
        usedHues.add(hue);
        colors.push(`hsl(${hue}, 70%, 70%)`);
      }
    }

    function drawWheel() {
      if (items.length === 0) return;

      const angle = 2 * Math.PI / items.length;
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      for (let i = 0; i < items.length; i++) {
        const startAngle = angle * i + angleOffset;
        const endAngle = startAngle + angle;
        ctx.beginPath();
        ctx.moveTo(center.x, center.y);
        ctx.arc(center.x, center.y, radius, startAngle, endAngle);
        ctx.fillStyle = colors[i];
        ctx.fill();
        ctx.stroke();

        // í…ìŠ¤íŠ¸
        ctx.save();
        ctx.translate(center.x, center.y);
        ctx.rotate(startAngle + angle / 2);
        ctx.textAlign = "right";
        ctx.fillStyle = "#000";
        ctx.font = "bold 16px sans-serif";
        ctx.fillText(items[i], radius - 10, 5);
        ctx.restore();
      }

      // ì¤‘ì•™ í™”ì‚´í‘œ
      ctx.beginPath();
      ctx.moveTo(center.x - 10, 10);
      ctx.lineTo(center.x + 10, 10);
      ctx.lineTo(center.x, 30);
      ctx.fillStyle = "#e74c3c";
      ctx.fill();
    }

    function spin() {
      if (!getItems() || spinning) return;
      spinning = true;

      let spinAngle = Math.random() * 360 + 1440; // ìµœì†Œ 4ë°”í€´
      let duration = 4000;
      let start = null;

      function animate(timestamp) {
        if (!start) start = timestamp;
        const elapsed = timestamp - start;

        const easing = (t) => 1 - Math.pow(1 - t, 3); // easeOutCubic
        const t = Math.min(1, elapsed / duration);
        const currentAngle = spinAngle * easing(t);
        angleOffset = currentAngle * Math.PI / 180;

        drawWheel();

        if (t < 1) {
          requestAnimationFrame(animate);
        } else {
          spinning = false;
          showResult();
        }
      }

      requestAnimationFrame(animate);
    }

    function showResult() {
      const anglePerItem = 2 * Math.PI / items.length;
      const finalAngle = (2 * Math.PI - (angleOffset % (2 * Math.PI))) % (2 * Math.PI);
      const selectedIndex = Math.floor(finalAngle / anglePerItem);
      const selected = items[selectedIndex];
    }

    window.onload = () => {
      updateInputFields(); // ì´ˆê¸° 2ê°œ ì„¸íŒ…
    };
  </script>
</body>
</html>
